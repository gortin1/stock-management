# ğŸ“¦ Stock Management API

Sistema de **GestÃ£o de Estoque para Mini Mercados**, desenvolvido em **Java 17** com **Spring Boot 3.5.5**, utilizando **arquitetura hexagonal (ports & adapters)**.  
A API permite o gerenciamento de **sellers**, **produtos** e **vendas**, garantindo seguranÃ§a via **JWT** e envio de mensagens via **Twilio**.

---

## ğŸš€ Tecnologias Utilizadas

- **Java 17**
- **Spring Boot 3.5.5**
    - Spring Web
    - Spring Data JPA
    - Spring Security
    - Spring Validation
- **PostgreSQL** (persistÃªncia de dados)
- **Lombok** (boilerplate reduction)
- **JWT (io.jsonwebtoken)** para autenticaÃ§Ã£o
- **Twilio SDK** (envio de mensagens WhatsApp)
- **Maven** (gerenciamento de dependÃªncias)

---

## ğŸ—ï¸ Arquitetura

A aplicaÃ§Ã£o segue a **arquitetura hexagonal**, separando bem as responsabilidades:

```
src/main/java/com/api/stock_management
â”‚
â”œâ”€â”€ application
â”‚   â”œâ”€â”€ controller       # Controllers REST
â”‚   â”‚   â”œâ”€â”€ AuthController
â”‚   â”‚   â”œâ”€â”€ ProductController
â”‚   â”‚   â”œâ”€â”€ SaleController
â”‚   â”‚   â””â”€â”€ SellerController
â”‚   â”‚
â”‚   â”œâ”€â”€ dto              # Objetos de transferÃªncia de dados (DTOs)
â”‚   â”‚   â”œâ”€â”€ auth (TokenResponseDTO)
â”‚   â”‚   â”œâ”€â”€ login (LoginRequestDTO)
â”‚   â”‚   â”œâ”€â”€ product (ProductRequestDTO, ProductResponseDTO)
â”‚   â”‚   â”œâ”€â”€ sale (SaleRequestDTO, SaleResponseDTO)
â”‚   â”‚   â””â”€â”€ seller (SellerRequestDTO, SellerResponseDTO, SellerActivateRequestDTO)
â”‚   â”‚
â”‚   â””â”€â”€ service          # Regras de negÃ³cio e orquestraÃ§Ã£o
â”‚       â”œâ”€â”€ AuthenticationService
â”‚       â”œâ”€â”€ ProductService
â”‚       â”œâ”€â”€ SaleService
â”‚       â””â”€â”€ SellerService
â”‚
â”œâ”€â”€ domain
â”‚   â”œâ”€â”€ model            # Entidades do domÃ­nio
â”‚   â”‚   â”œâ”€â”€ Product
â”‚   â”‚   â”œâ”€â”€ Sale
â”‚   â”‚   â””â”€â”€ Seller
â”‚   â”‚
â”‚   â””â”€â”€ repository       # Interfaces de acesso ao banco
â”‚       â”œâ”€â”€ ProductRepository
â”‚       â”œâ”€â”€ SaleRepository
â”‚       â””â”€â”€ SellerRepository
â”‚
â””â”€â”€ infrastructure
    â”œâ”€â”€ config           # ConfiguraÃ§Ãµes de seguranÃ§a
    â”‚   â”œâ”€â”€ SecretKeyGenerator
    â”‚   â””â”€â”€ SecurityConfig
    â”‚
    â”œâ”€â”€ messaging        # IntegraÃ§Ãµes externas
    â”‚   â””â”€â”€ TwilioService
    â”‚
    â””â”€â”€ security         # AutenticaÃ§Ã£o e JWT
        â”œâ”€â”€ JwtAuthFilter
        â””â”€â”€ TokenService
```

---

## ğŸ” SeguranÃ§a

- AutenticaÃ§Ã£o baseada em **JWT**.
- Cada **seller** sÃ³ pode visualizar e gerenciar **seus prÃ³prios produtos**.
- Filtros de seguranÃ§a definidos em `JwtAuthFilter` + `SecurityConfig`.

---

## âš™ï¸ Funcionalidades

- **Seller**
    - Cadastro e ativaÃ§Ã£o via cÃ³digo (Twilio WhatsApp).
    - Login e emissÃ£o de token JWT.
- **Produto**
    - CRUD de produtos.
    - RestriÃ§Ã£o: um seller sÃ³ gerencia os prÃ³prios produtos.
- **Venda**
    - Registro de vendas atÃ´micas com `@Transactional`.
    - VerificaÃ§Ã£o de estoque e status do produto.

---

## ğŸ› ï¸ ConfiguraÃ§Ã£o do Ambiente

### ğŸ“‘ application.properties
Edite o arquivo `src/main/resources/application.properties`:

```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/stockdb
spring.datasource.username=seu_usuario
spring.datasource.password=sua_senha

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# JWT
jwt.secret=chave_secreta_segura

# Twilio
twilio.accountSid=SEU_SID
twilio.authToken=SEU_TOKEN
twilio.phoneNumber=SEU_NUMERO
```

### â–¶ï¸ Rodando o projeto

```bash
# Build do projeto
mvn clean install

# Executar
mvn spring-boot:run
```

A API estarÃ¡ disponÃ­vel em:  
ğŸ‘‰ `http://localhost:8080`

---

## ğŸ“š Endpoints Principais

### ğŸ”‘ AutenticaÃ§Ã£o
- `POST /auth/login` â†’ Login do seller
- `POST /auth/activate` â†’ AtivaÃ§Ã£o via cÃ³digo (WhatsApp)

### ğŸ‘¤ Sellers
- `POST /sellers` â†’ Cadastro
- `GET /sellers/{id}` â†’ Detalhes do seller

### ğŸ“¦ Produtos
- `POST /products` â†’ Criar produto
- `GET /products` â†’ Listar produtos do seller logado
- `PUT /products/{id}` â†’ Atualizar produto
- `DELETE /products/{id}` â†’ Remover produto

### ğŸ’° Vendas
- `POST /sales` â†’ Registrar venda
- `GET /sales` â†’ Listar vendas do seller logado

---
